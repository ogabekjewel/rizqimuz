<%- include('parts/header') %>


<header class="header header-profile">
    <%- include('components/navbar', { logo: 'white' }) %>
</header>

<section class="profile">
    <header class="profile__header">
        <div class="flex-container">
            <div class="profile__owner">
                <div class="profile__avatar">
                    <label for="avatar">
                        <picture>
                            <source srcset="/img/<%= user.avatar %>" type="image/webp">
                            <img srcset="/img/<%= user.avatar %>">
                        </picture>
                    </label>
                    <input id="avatar" type="file" class="d-none">
                </div>
                <div class="profile__name">
                    <h1><%= user.first_name + ' ' + user.last_name %></h1>
                    <p>Web Developer</p>
                </div>
            </div>
            <a class="profile__mail" href="/<%= user.slug %>/mail">
                <span class="profile__mail-icon profile__mail-icon--unread">
                    <img src="/img/icons/email.svg" alt="email icon">
                </span>
                <span>Xabarlar</span>
            </a>
        </div>
    </header>
    <main class="profile__main">
        <div class="container">
            <section class="profile__section profile__section--basic">
                <div>
                    <header class="profile__section__header">
                        <h2 class="profile__section__heading">Ism, familiya</h2>
                        <div id="bio_edit" class="profile__section__edit" title="O'zgartirish">
                            <img src="/img/icons/edit.svg" alt="edit icon">
                        </div>
                    </header>
                    <main class="profile__section__main">
                        <p class="profile__section__text"><%= user.first_name + ' ' + user.last_name %></p>
                    </main>
                </div>
                <div>
                    <header class="profile__section__header">
                        <h2 class="profile__section__heading">Telefon raqam</h2>
                        <div id="bio_edit" class="profile__section__edit" title="O'zgartirish">
                            <img src="/img/icons/edit.svg" alt="edit icon">
                        </div>
                    </header>
                    <main class="profile__section__main">
                        <a class="profile__section__text" href="tel: +998999639773"><%= user.phone %> </a>
                    </main>
                </div>
                <div>
                    <header class="profile__section__header">
                        <h2 class="profile__section__heading">Elektron pochta</h2>
                        <div id="bio_edit" class="profile__section__edit" title="O'zgartirish">
                            <img src="/img/icons/edit.svg" alt="edit icon">
                        </div>
                    </header>
                    <main class="profile__section__main">
                        <a class="profile__section__text" href="mailto: <%= user.email %>" target="_blank"><%= user.email %></a>
                    </main>
                </div>
                <div>
                    <header class="profile__section__header">
                        <h2 class="profile__section__heading">Telegram username</h2>
                        <div id="bio_edit" class="profile__section__edit" title="O'zgartirish">
                            <img src="/img/icons/edit.svg" alt="edit icon">
                        </div>
                    </header>
                    <main class="profile__section__main">
                        <a class="profile__section__text" href="https://t.me/Ogabek19991031" target="_blank"><%= user.telegram_username %> </a>
                    </main>
                </div>
            </section>
            <section class="profile__section">
                <header class="profile__section__header">
                    <h2 class="profile__section__heading">O'zingiz haqingizda ma'lumot</h2>
                    <div class="profile__section__edit" title="O'zgartirish">
                        <img src="/img/icons/edit.svg" alt="edit icon">
                    </div>
                </header>
                <main class="profile__section__main">
                    <% if (!user.description) { %>
                        <div class="profile__section__empty">
                            <img src="/img/icons/empty.svg" alt="empty icon">
                            <p>Hozircha hech nima kiritilmagan</p>
                        </div>
                    <% } else { %>
                    <p class="profile__section__text"><%= user.description %></p>
                    <% } %>
                </main>
            </section>
            <section class="profile__section">
                <header class="profile__section__header">
                    <h2 class="profile__section__heading">Portfolio</h2>
                    <div class="profile__section__add" title="Qo'shish">
                        <img src="/img/icons/add.svg" alt="edit icon">
                    </div>
                </header>
                <% if (portfolios.length === 0) { %>
                    <div class="profile__section__empty">
                        <img src="/img/icons/empty.svg" alt="empty icon">
                        <p>Hozircha hech nima kiritilmagan</p>
                    </div>
                <% } else { %>
                    <main class="profile__section__main profile__section__main--grid">
                        <% for (let i = 0; i < portfolios.length; i++) { %>
                            <%- include('components/card', {
                                cardTitle: `${portfolios[i].name}`,
                                viewsCount: null,
                                workersCount: null,
                                cardType: `${portfolios[i].image}`,
                                cardLink: `${portfolios[i].link}`,
                                editable: true,
                            }) %>
                        <% } %>
                    </main>
                <% } %>
            </section>

<script>
    
</script>            

            <section class="profile__section">
                <header class="profile__section__header">
                    <h2 class="profile__section__heading">Ishlagan joylaringiz</h2>
                    <div class="profile__section__add" title="Qo'shish">
                        <img src="/img/icons/add.svg" alt="edit icon">
                    </div>
                </header>
                <% if (works.length === 0) { %>
                    <div class="profile__section__empty">
                        <img src="/img/icons/empty.svg" alt="empty icon">
                        <p>Hozircha hech nima kiritilmagan</p>
                    </div>
                <% } else { %>
                    <main class="profile__section__main">
                        <ul class="profile__experience__list">
                           <% for(let work of works) { %>
                                <li class="profile__experience__item">
                                    <h3 class="profile__experience__heading">
                                        <span><%= work.job_place %> <%= work.job_name %>  . <%= work.start_year %>,  <%= work.start_month %>  - <%= work.end_year %> , <%= work.end_month %> </span>
                                        <img class="profile__experience__edit" src="/img/icons/edit.svg" width="16" height="16" alt="edit icon" title="O'zgartirish">
                                    </h3>
                                    <p class="profile__section__text"><%= work.about %> </p>
                                </li>
                            <% } %>  
                        </ul>
                    </main>
                <% } %>
            </section>
            <section class="profile__section">
                <header class="profile__section__header">
                    <h2 class="profile__section__heading">O'qigan joylaringiz</h2>
                    <div class="profile__section__add" title="Qo'shish">
                        <img src="/img/icons/add.svg" alt="edit icon">
                    </div>
                </header>
                <% if (education.length === 0) { %>
                    <div class="profile__section__empty">
                        <img src="/img/icons/empty.svg" alt="empty icon">
                        <p>Hozircha hech nima kiritilmagan</p>
                    </div>
                <% } else { %>
                    <main class="profile__section__main">
                        <ul class="profile__education__list">
                            <% for(let edu of education) { %>
                                <li class="profile__education__item">
                                    <h3 class="profile__education__heading">
                                        <span><%= edu.name %>. <%= edu.direction %>   . <%= edu.start_year %> , <%= edu.start_month %>  - <%= edu.end_year %> , <%= edu.end_month %> </span>
                                        <img class="profile__education__edit" src="/img/icons/edit.svg" width="16" height="16" alt="edit icon" title="O'zgartirish">
                                    </h3>
                                    <p class="profile__section__text"><%= edu.about %></p>
                                </li>
                            <% } %>  
                        </ul>
                    </main>
                <% } %>
            </section>
            <section class="profile__section">
                <header class="profile__section__header">
                    <h2 class="profile__section__heading">Biladigan tillaringiz</h2>
                    <div class="profile__section__add" title="Qo'shish">
                        <img src="/img/icons/add.svg" alt="edit icon">
                    </div>
                </header>
                <% if (languages.length === 0) { %>
                    <div class="profile__section__empty">
                        <img src="/img/icons/empty.svg" alt="empty icon">
                        <p>Hozircha hech nima kiritilmagan</p>
                    </div>
                <% } else { %>
                    <main class="profile__section__main">
                        <ul class="profile__language__list">
                            <% for(let lang of languages) { %> 
                                <li class="profile__language__item">
                                    <h3 class="profile__language__heading">
                                        <span><%= lang.language %> </span>
                                        <img class="profile__language__edit" src="/img/icons/edit.svg" width="16" height="16" alt="edit icon" title="O'zgartirish">
                                    </h3>
                                    <p class="profile__section__text"><%= lang.degree %> </p>
                                </li>
                            <% } %> 
                        </ul>
                    </main>
                <% } %>
            </section>
            <section class="profile__section">
                <header class="profile__section__header">
                    <h2 class="profile__section__heading">Ko'nikmalaringiz</h2>
                    <div class="profile__section__add" title="Qo'shish">
                        <img src="/img/icons/add.svg" alt="add icon">
                    </div>
                </header>
                <% if (5 === 1) { %>
                    <div class="profile__section__empty">
                        <img src="/img/icons/empty.svg" alt="empty icon">
                        <p>Hozircha hech nima kiritilmagan</p>
                    </div>
                <% } else { %>
                    <main class="profile__section__main">
                        <ul class="profile__skills__list">
                            <li class="profile__skills__item">
                                <span class="profile__skills__name">HTML</span>
                                <span class="profile__skills__remove" title="Olib tashlash">
                                <img src="/img/icons/times-blue.svg" alt="remove skill icon">
                            </span>
                            </li>
                            <li class="profile__skills__item">
                                <span class="profile__skills__name">CSS</span>
                                <span class="profile__skills__remove" title="Olib tashlash">
                                <img src="/img/icons/times-blue.svg" alt="remove skill icon">
                            </span>
                            </li>
                            <li class="profile__skills__item">
                                <span class="profile__skills__name">JavaScript</span>
                                <span class="profile__skills__remove" title="Olib tashlash">
                                <img src="/img/icons/times-blue.svg" alt="remove skill icon">
                            </span>
                            </li>
                            <li class="profile__skills__item">
                                <span class="profile__skills__name">Sass</span>
                                <span class="profile__skills__remove" title="Olib tashlash">
                                <img src="/img/icons/times-blue.svg" alt="remove skill icon">
                            </span>
                            </li>
                            <li class="profile__skills__item">
                                <span class="profile__skills__name">Bootstrap</span>
                                <span class="profile__skills__remove" title="Olib tashlash">
                                <img src="/img/icons/times-blue.svg" alt="remove skill icon">
                            </span>
                            </li>
                            <li class="profile__skills__item">
                                <span class="profile__skills__name">Webpack</span>
                                <span class="profile__skills__remove" title="Olib tashlash">
                                <img src="/img/icons/times-blue.svg" alt="remove skill icon">
                            </span>
                            </li>
                            <li class="profile__skills__item">
                                <span class="profile__skills__name">Webpack</span>
                                <span class="profile__skills__remove" title="Olib tashlash">
                                <img src="/img/icons/times-blue.svg" alt="remove skill icon">
                            </span>
                            </li>
                            <li class="profile__skills__item">
                                <span class="profile__skills__name">Babel</span>
                                <span class="profile__skills__remove" title="Olib tashlash">
                                <img src="/img/icons/times-blue.svg" alt="remove skill icon">
                            </span>
                            </li>
                            <li class="profile__skills__item">
                                <span class="profile__skills__name">Git</span>
                                <span class="profile__skills__remove" title="Olib tashlash">
                                <img src="/img/icons/times-blue.svg" alt="remove skill icon">
                            </span>
                            </li>
                            <li class="profile__skills__item">
                                <span class="profile__skills__name">Vue</span>
                                <span class="profile__skills__remove" title="Olib tashlash">
                                <img src="/img/icons/times-blue.svg" alt="remove skill icon">
                            </span>
                            </li>
                            <li class="profile__skills__item">
                                <span class="profile__skills__name">NodeJS</span>
                                <span class="profile__skills__remove" title="Olib tashlash">
                                <img src="/img/icons/times-blue.svg" alt="remove skill icon">
                            </span>
                            </li>
                            <li class="profile__skills__item">
                                <span class="profile__skills__name">ExpressJS</span>
                                <span class="profile__skills__remove" title="Olib tashlash">
                                <img src="/img/icons/times-blue.svg" alt="remove skill icon">
                            </span>
                            </li>
                            <li class="profile__skills__item">
                                <span class="profile__skills__name">Postgres</span>
                                <span class="profile__skills__remove" title="Olib tashlash">
                                <img src="/img/icons/times-blue.svg" alt="remove skill icon">
                            </span>
                            </li>
                            <li class="profile__skills__item">
                                <span class="profile__skills__name">Mongo</span>
                                <span class="profile__skills__remove" title="Olib tashlash">
                                <img src="/img/icons/times-blue.svg" alt="remove skill icon">
                            </span>
                            </li>
                        </ul>
                    </main>
                <% } %>
            </section>
            <section class="profile__section">
                <header class="profile__section__header">
                    <h2 class="profile__section__heading">Ijtimoiy tarmoqdagi sahifalaringiz</h2>
                    <div class="profile__section__add" title="Qo'shish">
                        <img src="/img/icons/add.svg" alt="add icon">
                    </div>
                </header>
                <% if (5 < 1) { %>
                    <div class="profile__section__empty">
                        <img src="/img/icons/empty.svg" alt="empty icon">
                        <p>Hozircha hech nima kiritilmagan</p>
                    </div>
                <% } else { %>
                    <main class="profile__section__main">
                        <ul class="profile__links__list">
                            <li class="profile__links__item">
                                <a class="profile__links__link" href="#" target="_blank">
                                    <img src="/img/icons/site.svg" alt="network icon">
                                    <span>Web sayt</span>
                                    <img class="profile__link__edit" src="/img/icons/edit.svg" width="16" height="16" alt="edit icon" title="O'zgartirish">
                                </a>
                                <a class="profile__links__link" href="#" target="_blank">
                                    <img src="/img/icons/youtube.svg" alt="youtube icon">
                                    <span>YouTube</span>
                                    <img class="profile__link__edit" src="/img/icons/edit.svg" width="16" height="16" alt="edit icon" title="O'zgartirish">
                                </a>
                                <a class="profile__links__link" href="#" target="_blank">
                                    <img src="/img/icons/git.svg" alt="git icon">
                                    <span>Github</span>
                                    <img class="profile__link__edit" src="/img/icons/edit.svg" width="16" height="16" alt="edit icon" title="O'zgartirish">
                                </a>
                            </li>
                        </ul>
                    </main>
                <% } %>
            </section>
        </div>
    </main>
</section>

<script>
    let imgInput = document.querySelector("#avatar") 
    imgInput.addEventListener("change", async (e) => {
        let file = e.target.files[0]

        let formData = new FormData()

        formData.append("photo", file)

        let response = await fetch(`/avatar`, {
            method: "PATCH",
            body: formData,
        })

        response = await response.json()

        if(response.ok) {
            window.location.reload()
        }
    })
</script>



<%- include('components/modal') %>

<!-- <script src="/js/user_profile.js"></script>    -->

<%- include('components/footer') %>
<%- include('parts/footer') %>